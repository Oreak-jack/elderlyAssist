<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cn.edu.tute.schoolproject.mapper.home.BooksMapper">
    <!-- 查询所有图书 -->
    <select id="getAllBooks" resultType="cn.edu.tute.schoolproject.entity.Books">
        SELECT * FROM Books
    </select>
    
    <!-- 根据ID查询图书 -->
    <select id="getBookById" resultType="cn.edu.tute.schoolproject.entity.Books">
        SELECT * FROM Books WHERE id = #{id}
    </select>
    
    <!-- 更新图书信息 -->
    <update id="updateBook" parameterType="cn.edu.tute.schoolproject.entity.Books">
        UPDATE Books 
        SET nums = #{nums}
        WHERE id = #{id}
    </update>
    
    <!-- 根据分类查询图书 -->
    <select id="getBooksByCategory" resultType="cn.edu.tute.schoolproject.entity.Books">
        SELECT * FROM Books WHERE category = #{category}
    </select>
    
    <!-- 根据书名或分类模糊查询 -->
    <select id="searchBooks" resultType="cn.edu.tute.schoolproject.entity.Books">
        SELECT * FROM Books 
        WHERE bookName LIKE CONCAT('%', REPLACE(#{keyword}, "'", ""), '%')
        OR category LIKE CONCAT('%', REPLACE(#{keyword}, "'", ""), '%')
    </select>

    <!-- 获取所有图书分类 -->
    <select id="getAllCategories" resultType="string">
        SELECT DISTINCT category FROM Books ORDER BY category
    </select>
</mapper>
